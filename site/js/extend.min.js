(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){function ajax(data,headers,method,url){headers=headers||{};method=method||"post";url=url||"/";var Promise=require("apromise");var x=new XMLHttpRequest,p=new Promise;x.onreadystatechange=function(e){switch(x.readyState){case 1:Object.keys(headers).forEach(function(k){x.setRequestHeader(k,headers[k])});break;case 4:switch(x.status){case 200:p.resolve(x.getResponseHeader("content-type").indexOf("json")!=-1?JSON.parse(x.responseText):x.responseText);break;default:p.reject(new Error(x.responseText))}default:}};x.open(method,url,true);x.send(data);return p}Node.prototype.$1=Element.prototype.querySelector;Node.prototype.$=Element.prototype.querySelectorAll;NodeList.prototype.forEach=Array.prototype.forEach;function extend(a,b){for(var i in b)b[i]!=undefined&&(a[i]=b[i]);return a}Function.prototype.asTemplate=function(input){var content=this.toString();content=content.substring(content.indexOf("/*")+2,content.lastIndexOf("*/"));return!input?content:content.replace(/\$\{(.*)\}/gm,function(a,b){return input[b]||""})};var swap,body=document.body;if(swap=body.$1(".component.comments")){var addComment;swap.innerHTML=function(){}.asTemplate();ajax(null,null,"get","/comment").then(function(comments){comments.forEach(addComment=function(c){var li=document.createElement("li");this.appendChild(li);li.innerHTML=c.user+" said on "+c.createdAt+"<p>"+c.comment+"</p>"}.bind(body.$1("#commentList")))});swap.$1("button").onclick=function(){var data={createdAt:new Date,user:body.$1("#newComment>input").value,comment:body.$1("#newComment>textarea").value};ajax(JSON.stringify(data),{"content-type":"application/json"},"post","/comment").then(function(){addComment(data);body.$1("#newComment").reset()},function(e){alert("error when saving comment: "+e.message)})}}ajax(null,null,"get","/info").then(function(posts){var name=document.title.replace(/\.html$/,""),len=posts.length,index=0;for(var i=0;i<len;i++){if(posts[i].name==name){index=i;break}}(swap=body.$('a[href="#next"]'))&&swap.forEach(function(a){a.onclick=function(){len>index+1&&(document.location=posts[index+1])}});(swap=body.$('a[href="#prev"]'))&&swap.forEach(function(a){a.onclick=function(){index-1>-1&&(document.location=posts[index-1])}});if(swap=body.$1(".component.list")){swap.innerHTML=posts.map(function(p){return'<h6 data-keywords="'+(p.keywords||"")+'"><a href="'+p.name+'.html">'+p.name+"</a></h6>"}).join("")}typeof posts[index].keywords!="undefined"&&(swap=body.$(".component.keywords"))&&swap.forEach(function(a){a.innerHTML=posts[index].keywords.join(",")})});(swap=body.$(".component.googleAD"))&&swap.forEach(function(a){a.innerHTML=function(){}.asTemplate(extend({client:"ca-pub-8043169935696401",slot:"5457625779",width:"320px",height:"100px"},new Function("a,b,c,d","return {client:a,slot:b,width:c,height:d}")(a.getAttribute("data-input").split(","))))});if(swap=body.$1(".component.search")){swap.innerHTML='<input type="search" style="width:90%;margin:5px auto;padding:5px">';swap.$1("input").onchange=function(){var list=body.$1(".component.list");list.children.forEach(function(a){a.style.display="none"});list&&list.$('[data-keywords*="'+this.value+'"]').forEach(function(a){a.style.display="block"})}}},{apromise:2}],2:[function(require,module,exports){(function(define){define(["extend"],function(Extend){var _={extend:Extend,isFunction:function(a){return typeof a=="function"||false},isUndefined:function(a){return a===void 0},clone:function(a){return this.extend(true,{},a)},arrayEach:function(a,f){for(var i=0,len=a.length;i<len;i++)f(a[i])},isNullOrUndefined:function(a){return a===null||this.isUndefined()}};var Promise=function(){this._resolved=false;this._rejected=false;this._resolvedCallbacks=[];this._rejectedCallbacks=[]};_.extend(Promise,{is:function(promise){return promise&&promise.then&&_.isFunction(promise.then)},as:function(){var promise=new Promise;promise.resolve.apply(promise,arguments);return promise},error:function(){var promise=new Promise;promise.reject.apply(promise,arguments);return promise},when:function(promises){var objects;if(promises&&_.isNullOrUndefined(promises.length)){objects=arguments}else{objects=promises}var total=objects.length;var hadError=false;var results=[];var errors=[];results.length=objects.length;errors.length=objects.length;if(total===0){return Promise.as.apply(this,results)}var promise=new Promise;var resolveOne=function(){total=total-1;if(total===0){if(hadError){promise.reject(errors)}else{promise.resolve.apply(promise,results)}}};_.arrayEach(objects,function(object,i){if(Promise.is(object)){object.then(function(result){results[i]=result;resolveOne()},function(error){errors[i]=error;hadError=true;resolveOne()})}else{results[i]=object;resolveOne()}});return promise},_continueWhile:function(predicate,asyncFunction){if(predicate()){return asyncFunction().then(function(){return Promise._continueWhile(predicate,asyncFunction)})}return Promise.as()}});_.extend(Promise.prototype,{resolve:function(result){if(this._resolved||this._rejected){throw"A promise was resolved even though it had already been "+(this._resolved?"resolved":"rejected")+"."}this._resolved=true;this._result=arguments;var results=arguments;_.arrayEach(this._resolvedCallbacks,function(resolvedCallback){resolvedCallback.apply(this,results)});this._resolvedCallbacks=[];this._rejectedCallbacks=[]},reject:function(error){if(this._resolved||this._rejected){throw"A promise was rejected even though it had already been "+(this._resolved?"resolved":"rejected")+"."}this._rejected=true;this._error=error;_.arrayEach(this._rejectedCallbacks,function(rejectedCallback){rejectedCallback(error)});this._resolvedCallbacks=[];this._rejectedCallbacks=[]},then:function(resolvedCallback,rejectedCallback){var promise=new Promise;var wrappedResolvedCallback=function(){var result=arguments;if(resolvedCallback){result=[resolvedCallback.apply(this,result)]}if(result.length===1&&Promise.is(result[0])){result[0].then(function(){promise.resolve.apply(promise,arguments)},function(error){promise.reject(error)})}else{promise.resolve.apply(promise,result)}};var wrappedRejectedCallback=function(error){var result=[];if(rejectedCallback){result=[rejectedCallback(error)];if(result.length===1&&Promise.is(result[0])){result[0].then(function(){promise.resolve.apply(promise,arguments)},function(error){promise.reject(error)})}else{promise.reject(result[0])}}else{promise.reject(error)}};if(this._resolved){wrappedResolvedCallback.apply(this,this._result)}else if(this._rejected){wrappedRejectedCallback(this._error)}else{this._resolvedCallbacks.push(wrappedResolvedCallback);this._rejectedCallbacks.push(wrappedRejectedCallback)}return promise},_thenRunCallbacks:function(optionsOrCallback,model){var options;if(_.isFunction(optionsOrCallback)){var callback=optionsOrCallback;options={success:function(result){callback(result,null)},error:function(error){callback(null,error)}}}else{options=_.clone(optionsOrCallback)}options=options||{};return this.then(function(result){if(options.success){options.success.apply(this,arguments)}else if(model){model.trigger("sync",model,result,options)}return Promise.as.apply(Promise,arguments)},function(error){if(options.error){if(!_.isUndefined(model)){options.error(model,error)}else{options.error(error)}}else if(model){model.trigger("error",model,error,options)}return Promise.error(error)})},_continueWith:function(continuation){return this.then(function(){return continuation(arguments,null)},function(error){return continuation(null,error)})}});return Promise})})(typeof define!=="undefined"?define:typeof module!=="undefined"?function(deps,factory){module.exports=factory(require("extend"))}:function(deps,factory){this.Promise=factory()})},{extend:3}],3:[function(require,module,exports){var hasOwn=Object.prototype.hasOwnProperty;var toString=Object.prototype.toString;var undefined;var isPlainObject=function isPlainObject(obj){"use strict";if(!obj||toString.call(obj)!=="[object Object]"){return false}var has_own_constructor=hasOwn.call(obj,"constructor");var has_is_property_of_method=obj.constructor&&obj.constructor.prototype&&hasOwn.call(obj.constructor.prototype,"isPrototypeOf");if(obj.constructor&&!has_own_constructor&&!has_is_property_of_method){return false}var key;for(key in obj){}return key===undefined||hasOwn.call(obj,key)};module.exports=function extend(){"use strict";var options,name,src,copy,copyIsArray,clone,target=arguments[0],i=1,length=arguments.length,deep=false;if(typeof target==="boolean"){deep=target;target=arguments[1]||{};i=2}else if(typeof target!=="object"&&typeof target!=="function"||target==null){target={}}for(;i<length;++i){options=arguments[i];if(options!=null){for(name in options){src=target[name];copy=options[name];if(target===copy){continue}if(deep&&copy&&(isPlainObject(copy)||(copyIsArray=Array.isArray(copy)))){if(copyIsArray){copyIsArray=false;clone=src&&Array.isArray(src)?src:[]}else{clone=src&&isPlainObject(src)?src:{}}target[name]=extend(deep,clone,copy)}else if(copy!==undefined){target[name]=copy}}}}return target}},{}]},{},[1]);